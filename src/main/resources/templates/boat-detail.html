<!doctype html>
<html lang="en" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Boat Detail</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/mobile.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css"
          integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
          integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
            integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
            crossorigin=""></script>
</head>

<style>
    .opinion-my {
        border: 1px solid #ccc;
        padding: 15px;
        margin-bottom: 20px;
    }

    .comment {
        background-color: #f9f9f9;
        border: 1px solid #ddd;
        padding: 5px;
        margin: 5px 5px;
    }

    .comment:not(:last-child) {
        margin-bottom: 10px;
    }

    .text-content-my {
        font-weight: bold;
    }

    .author {
        margin-bottom: 3px;
    }

</style>

<body>

<div class="wrapper">

    <div class="details-main" th:object="${boat}">
        <section class="route-info text-center">
            <h4 id="track-name" th:text="*{name}"></h4>
            <p>Author name: Hristo Taushanov<span id="authorName"></span></p>
        </section>


        <section class="route-description text-center">
            <h4>Description:</h4>
            <p id="route-description" th:text="*{description}">Description: </p>
        </section>


        <section class="gallery">
            <img class="rounded" th:each="p : *{photo}" th:src="${p}" height="100%" alt="">
        </section>


        <section class="comments">
            <h1>Opinions</h1>

            <div>
                <!-- Comments submission -->
                <form id="commentForm"
                      method="POST"
                      th:action="@{/boat/detail/add-opinion/{id}(id=${boat.id})}">
                    <div class="form-group">
                        <h4>Leave your opinion here</h4>
                        <textarea name="message"
                                  id="message"
                                  cols="30"
                                  rows="5"
                                  class="form-control"
                                  th:value="${opinionForm.message}"
                                  style="background-color: white;"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit</button>
                </form>
                <!-- Comments submission -->
            </div>

            <!-- All comments section -->
            <div>

                <span id="commentCtnr"><!-- Comments section, filled in by script --></span>
            </div>
            <!-- EO: All comments section -->
        </section>

        <section class="opinions">
            <h1>Opinions</h1>
            <div th:each="o : *{opinions}" class="opinion-my">
                <p>Author username: <span th:text="${o.author}" class="author"></span></p>
                <p>Date: <span th:text="${#temporals.format(o.created, 'dd-MM-yyyy HH:mm')}" class="date"></span></p>
                <p>Opinion: <span class="text-content-my" th:text="${o.textContent}"></span></p>
                <div class="comments" th:each="c : ${o.comments}">
                    <div class="comment">
                        <p>Author username: <span th:text="${c.author}" class="author"></span></p>
                        <p>Date: <span th:text="${#temporals.format(c.created, 'dd-MM-yyyy HH:mm')}" class="date"></span></p>
                        <p>Comment: <span class="text-content-my" th:text="${c.content}"></span></p>
                    </div>
                </div>

                <form id="commentFormAnswer"
                      method="POST"
                      th:action="@{/boat/detail/add-comment/{id}/{opinionId}(id=${boat.id}, opinionId=${o.id})}"
                      th:object="${commentForm}">
                    <div class="form-group">
                        <h4>Leave your comment here</h4>
                        <textarea name="commentContent"
                                  id="commentContent"
                                  cols="30"
                                  rows="5"
                                  class="form-control"
                                  th:field="*{commentContent}"
                                  style="background-color: white;"></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit</button>
                </form>

            </div>
        </section>

        </div>
    </div>
</body>
</html>
